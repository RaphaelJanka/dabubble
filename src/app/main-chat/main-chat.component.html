<mat-drawer-container autosize>
  <mat-card class="mr-16">
    <mat-card-header>
      <div class="header">
        <button (click)="openEditChannelDialog()" mat-button>
          <div class="chat-title">
            <img src="assets/img/icons/tag.svg" alt="" class="mr-16" />
            <span class="mr-16">{{ currentChat?.name || '' }}</span>
            <mat-icon>expand_more</mat-icon>
          </div>
        </button>
        <div class="group-members-container">

          <button mat-button class="group-members-button" (click)="openMemberDialog()">
            <div class="group-members-container">
              <div class="group-members">
                <img src="assets/img/avatars/avatar_male2.svg" alt="" />
                <img src="assets/img/avatars/avatar_male2.svg" alt="" />
                <img src="assets/img/avatars/avatar_male2.svg" alt="" />
              </div>

              <h3 class="member-count">5</h3>
            </div>
          </button>

          <button mat-icon-button class="add-user" (click)="openDialog()">
            <img src="assets/img/icons/add-person.svg" alt="" />
          </button>
        </div>
      </div>
    </mat-card-header>

    <mat-card-content #messageContainer class="p-0 main-chat-container">
      <ng-container *ngFor="let organizedMessage of organizedMessages.slice().reverse()">
        <section>
          <div class="date-container">
            <div class="separator"></div>
            <div class="time-box">{{  isToday(organizedMessage.date) ? 'Today' : organizedMessage.date }}</div>
            <div class="separator"></div>
          </div>

          <div class="message-row-container" [ngClass]="{'my-messages': message.creator == currentUser.name}"
          *ngFor="let message of organizedMessage.messages">

            <div class="message-box">
              <div class="creator-picture-container">
                <img src="{{message.profilePic}}" alt="" />
              </div>

              <div class="message-container">
                <div class="message-data">
                  <span class="name">{{ message.creator }}</span>
                  <span class="date">{{message.time}}</span>
                </div>

                <div
                  [ngClass]="{'my-message-content': message.creator == currentUser.name, 'message-content': message.creator != currentUser.name}">
                  <span> {{message.content}}</span>
                </div>

                <div class="reaction-container">
                  <div class="reaction-emoji-container">
                    <button class="reaction-emoji-button">
                      <img src="{{reaction.content}}" alt="rocket" />
                      <span>1</span>
                    </button>

                    <!-- <button class="add-reaction-button" mat-icon-button>d
                      <img src="assets/img/icons/add_reaction.svg" alt="" />
                    </button> -->

                  </div>

                  <div class="comment-section" (click)="thread.toggle()">
                    <span class="comments color-purple2-text">2 Answers</span>
                    <span class="last-comment">Last Answer 14:55</span>
                  </div>

                </div>
              </div>
            </div>

            <div class="reaction" [ngClass]="{'own-message': message.creator == currentUser.name}">
              <button mat-icon-button (click)="addReaction('assets/img/emojis/checkGreen.svg', message.id)">
                <img src="assets/img/emojis/checkGreen.svg" alt="">
              </button>
              <button mat-icon-button (click)="addReaction('assets/img/emojis/hands.svg', message.id)"> 
                <img src="assets/img/emojis/hands.svg" alt="">
              </button>
              <button mat-icon-button>
                <img src="assets/img/icons/add_reaction.svg" alt="">
              </button>
              <button mat-icon-button>
                <img src="assets/img/icons/comment.svg" alt="">
              </button>
              <button mat-icon-button *ngIf="message.creator == currentUser.name">
                <img src="assets/img/icons/edit_square.svg" alt="">
              </button>
            </div>
          </div>
        </section>
      </ng-container>
    </mat-card-content>

    <mat-card-content class="textfield-content">
      <div class="text-field-container">
        <textarea (keyup.enter)="sendMessage()" [(ngModel)]="message.content" placeholder="Message to #Entwicklerteam"></textarea>

        <div class="message-buttons">
          <div class="attachments">
            <div class="border-right">
              <button mat-icon-button>
                <img src="assets/img/icons/add.svg" alt="" />
              </button>
            </div>

            <button mat-icon-button>
              <img src="assets/img/icons/smiley.svg" alt="" />
            </button>

            <button mat-icon-button>
              <img src="assets/img/icons/@.svg" alt="" />
            </button>
          </div>

          <button mat-icon-button (click)="sendMessage()">
            <img src="assets/img/icons/send.svg" alt="" />
          </button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>


  <mat-drawer #thread mode="side" position="end">
    <app-thread (closeThread)="onCloseThread()"></app-thread>
  </mat-drawer>

</mat-drawer-container>